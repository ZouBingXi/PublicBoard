(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ba56812"],{"04d0":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"background"}},[o("div",{attrs:{id:"base"}},[o("div",{attrs:{id:"edit-background"}}),o("div",{attrs:{id:"edit-combo"}},[e._m(0),o("el-divider"),o("div",{attrs:{id:"input-form"}},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px","label-position":"top"}},[o("el-form-item",{attrs:{id:"input-form-item1",label:"标题",prop:"title"}},[o("el-input",{attrs:{placeholder:"请填写标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),o("el-form-item",{attrs:{id:"input-form-item2",label:"类型",prop:"type"}},[o("el-radio-group",{attrs:{fill:"#909399"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[o("el-radio-button",{attrs:{label:"贴子"}}),o("el-radio-button",{attrs:{label:"话题"}})],1)],1),o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"贴子"==e.ruleForm.type,expression:"ruleForm.type == '贴子'"}],attrs:{id:"input-form-item3",prop:"newstype"}},[o("el-radio-group",{attrs:{fill:"#909399"},model:{value:e.ruleForm.newstype,callback:function(t){e.$set(e.ruleForm,"newstype",t)},expression:"ruleForm.newstype"}},[o("el-radio-button",{attrs:{label:"校园卡丢失"}}),o("el-radio-button",{attrs:{label:"寻物"}}),o("el-radio-button",{attrs:{label:"寻主"}}),o("el-radio-button",{attrs:{label:"捞人"}}),o("el-radio-button",{attrs:{label:"求助"}})],1)],1),o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"话题"==e.ruleForm.type,expression:"ruleForm.type == '话题'"}],attrs:{id:"input-form-item4",prop:"subjecttype"}},[o("el-radio-group",{attrs:{fill:"#909399"},model:{value:e.ruleForm.subjecttype,callback:function(t){e.$set(e.ruleForm,"subjecttype",t)},expression:"ruleForm.subjecttype"}},[o("el-radio-button",{attrs:{label:"避雷"}}),o("el-radio-button",{attrs:{label:"树洞"}}),o("el-radio-button",{attrs:{label:"指南"}}),o("el-radio-button",{attrs:{label:"课程"}})],1)],1),o("el-form-item",{attrs:{id:"input-form-item5",label:"内容",prop:"content"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:5},placeholder:"请填写内容",maxlength:"1000","show-word-limit":""},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),o("el-form-item",{attrs:{id:"input-form-item6",label:"插入图片（ 限制 3 张大小不超过 2MB 的 JPG 格式图片 ）"}},[o("el-upload",{attrs:{action:"#","list-type":"picture-card","auto-upload":!1,"file-list":e.fileList,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-change":e.handleChange,"before-remove":e.handleBeforeRemove,"before-upload":e.handleBeforeUpload,multiple:"",limit:3,"on-exceed":e.handleExceed,accept:"image/jpeg"}},[o("i",{staticClass:"el-icon-plus"})])],1)],1)],1),o("el-divider"),o("div",{attrs:{id:"input-button"}},[o("el-button",{attrs:{id:"input-button1",type:"info"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确认发布")]),o("el-button",{attrs:{id:"input-button2",type:"danger"},on:{click:function(t){return e.gotoHome("ruleForm")}}},[e._v("取消")])],1)],1)]),o("div",[o("el-dialog",{attrs:{id:"img-enlarge",visible:e.dialogVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),o("el-backtop")],1)},l=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"edit-text"}},[o("p",{attrs:{id:"edit-text1"}},[e._v("发布")])])}],a=o("5530"),i=(o("d3b7"),o("159b"),o("99af"),o("b0c0"),o("2f62")),s={data:function(){return{ruleForm:{title:"",type:"贴子",newstype:"校园卡丢失",subjecttype:"避雷",content:""},rules:{title:[{required:!0,message:"请填写标题",trigger:"blur"},{max:25,message:"长度不超过 25 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],newstype:[{required:!0,message:"请选择贴子类型",trigger:"change"}],subjecttype:[{required:!0,message:"请选择话题类型",trigger:"change"}],content:[{required:!0,message:"请填写内容",trigger:"blur"},{min:20,max:1e3,message:"长度在 20 到 1000 个字符",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,fileList:[]}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(o){if(!o)return t.$message({showClose:!0,message:"发布失败",type:"error"}),!1;var r=t,l=0;if("贴子"==r.ruleForm.type){switch(r.ruleForm.newstype){case"校园卡丢失":l=1;break;case"寻物":l=2;break;case"寻主":l=3;break;case"捞人":l=4;break;case"求助":l=5;break}var a=new FormData;0!=t.fileList.length&&(console.log("fileList展示"),console.log(t.fileList),t.fileList.forEach((function(e){return a.append("image",e.raw)}))),a.append("newstitle",r.ruleForm.title),a.append("content",r.ruleForm.content),a.append("newstypeid",l),console.log("param展示"),0!=t.fileList.length&&console.log(a.getAll("image")),console.log(a.getAll("newstitle")),console.log(a.getAll("content")),console.log(a.getAll("newstypeid"));var i={headers:{"Content-Type":"multipart/form-data"}};t.$axios.post("/news/addwithimages",a,i).then((function(o){200==o.data.code?(t.$refs[e].resetFields(),t.$message({showClose:!0,message:o.data.msg,type:"success"}),t.$router.push({path:"/"})):t.$message({showClose:!0,message:o.data.msg,type:"error"})}))}else{switch(r.ruleForm.subjecttype){case"避雷":l=1;break;case"树洞":l=2;break;case"指南":l=3;break;case"课程":l=4;break}var s=new FormData;0!=t.fileList.length&&(console.log("fileList展示"),console.log(t.fileList),t.fileList.forEach((function(e){return s.append("image",e.raw)}))),s.append("subjecttitle",r.ruleForm.title),s.append("content",r.ruleForm.content),s.append("subjecttypeid",l),console.log("param展示"),0!=t.fileList.length&&console.log(s.getAll("image")),console.log(s.getAll("subjecttitle")),console.log(s.getAll("content")),console.log(s.getAll("subjecttypeid"));var n={headers:{"Content-Type":"multipart/form-data"}};t.$axios.post("/subject/addwithimages",s,n).then((function(o){200==o.data.code?(t.$refs[e].resetFields(),t.$message({showClose:!0,message:o.data.msg,type:"success"}),t.$router.push({path:"/"})):t.$message({showClose:!0,message:o.data.msg,type:"error"})}))}}))},gotoHome:function(e){this.$refs[e].resetFields(),this.$router.push({path:"/"})},handlePreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove:function(e,t){console.log("删除操作"),this.fileList.pop(),console.log(e,t),console.log(this.fileList)},handleExceed:function(e,t){this.$message.warning("当前限制最多插入 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},handleBeforeUpload:function(e){console.log(e)},handleBeforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleChange:function(e,t){var o="image/jpeg"===e.raw.type,r=e.size/1024/1024<2;o?r?(console.log("添加操作"),this.fileList.push(e)):(this.$message.error("上传图片大小不能超过 2MB!"),t.pop()):(this.$message.error("上传图片只能是 JPG 格式!"),t.pop()),console.log(e,t),console.log(this.fileList)}},computed:Object(a["a"])({},Object(i["b"])(["currentUser","isAuthenticated"]))},n=s,u=(o("228c"),o("2877")),c=Object(u["a"])(n,r,l,!1,null,"6785afcb",null);t["default"]=c.exports},"228c":function(e,t,o){"use strict";o("883a")},"883a":function(e,t,o){},"99af":function(e,t,o){"use strict";var r=o("23e7"),l=o("da84"),a=o("d039"),i=o("e8b5"),s=o("861d"),n=o("7b0b"),u=o("07fa"),c=o("8418"),d=o("65f0"),m=o("1dde"),p=o("b622"),g=o("2d00"),f=p("isConcatSpreadable"),b=9007199254740991,h="Maximum allowed index exceeded",v=l.TypeError,w=g>=51||!a((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),y=m("concat"),F=function(e){if(!s(e))return!1;var t=e[f];return void 0!==t?!!t:i(e)},$=!w||!y;r({target:"Array",proto:!0,forced:$},{concat:function(e){var t,o,r,l,a,i=n(this),s=d(i,0),m=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?i:arguments[t],F(a)){if(l=u(a),m+l>b)throw v(h);for(o=0;o<l;o++,m++)o in a&&c(s,m,a[o])}else{if(m>=b)throw v(h);c(s,m++,a)}return s.length=m,s}})},b0c0:function(e,t,o){var r=o("83ab"),l=o("5e77").EXISTS,a=o("e330"),i=o("9bf2").f,s=Function.prototype,n=a(s.toString),u=/^\s*function ([^ (]*)/,c=a(u.exec),d="name";r&&!l&&i(s,d,{configurable:!0,get:function(){try{return c(u,n(this))[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-6ba56812.648549ce.js.map