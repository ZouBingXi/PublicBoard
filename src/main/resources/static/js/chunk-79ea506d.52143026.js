(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79ea506d"],{"04d0":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"background"}},[r("div",{attrs:{id:"base"}},[r("div",{attrs:{id:"edit-background"}}),r("div",{attrs:{id:"edit-combo"}},[e._m(0),r("el-divider"),r("div",{attrs:{id:"input-form"}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px","label-position":"top"}},[r("el-form-item",{attrs:{id:"input-form-item1",label:"标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请填写标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{id:"input-form-item2",label:"类型",prop:"type"}},[r("el-radio-group",{attrs:{fill:"#909399"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[r("el-radio-button",{attrs:{label:"贴子"}}),r("el-radio-button",{attrs:{label:"话题"}})],1)],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"贴子"==e.ruleForm.type,expression:"ruleForm.type == '贴子'"}],attrs:{id:"input-form-item3",prop:"newstype"}},[r("el-radio-group",{attrs:{fill:"#909399"},model:{value:e.ruleForm.newstype,callback:function(t){e.$set(e.ruleForm,"newstype",t)},expression:"ruleForm.newstype"}},[r("el-radio-button",{attrs:{label:"校园卡丢失"}}),r("el-radio-button",{attrs:{label:"寻物"}}),r("el-radio-button",{attrs:{label:"寻主"}}),r("el-radio-button",{attrs:{label:"捞人"}}),r("el-radio-button",{attrs:{label:"求助"}})],1)],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"话题"==e.ruleForm.type,expression:"ruleForm.type == '话题'"}],attrs:{id:"input-form-item4",prop:"subjecttype"}},[r("el-radio-group",{attrs:{fill:"#909399"},model:{value:e.ruleForm.subjecttype,callback:function(t){e.$set(e.ruleForm,"subjecttype",t)},expression:"ruleForm.subjecttype"}},[r("el-radio-button",{attrs:{label:"避雷"}}),r("el-radio-button",{attrs:{label:"树洞"}}),r("el-radio-button",{attrs:{label:"指南"}}),r("el-radio-button",{attrs:{label:"课程"}})],1)],1),r("el-form-item",{attrs:{id:"input-form-item5",label:"内容",prop:"content"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:10},placeholder:"请填写内容"},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),r("el-form-item",{attrs:{id:"input-form-item6",label:"插入图片（ 限制 3 张大小不超过 2MB 的 JPG 格式图片 ）"}},[r("el-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts/","list-type":"picture-card","auto-upload":!1,"file-list":e.fileList,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-change":e.handleChange,"before-remove":e.handleBeforeRemove,"before-upload":e.handleBeforeUpload,multiple:"",limit:3,"on-exceed":e.handleExceed,accept:"image/jpeg"}},[r("i",{staticClass:"el-icon-plus"})])],1)],1)],1),r("el-divider"),r("div",{attrs:{id:"input-button"}},[r("el-button",{attrs:{id:"input-button1",type:"info"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确认发布")]),r("el-button",{attrs:{id:"input-button2",type:"danger"},on:{click:function(t){return e.gotoHome("ruleForm")}}},[e._v("取消")])],1)],1)]),r("div",[r("el-dialog",{attrs:{id:"img-enlarge",visible:e.dialogVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"edit-text"}},[r("p",{attrs:{id:"edit-text1"}},[e._v("发布")])])}],i=r("5530"),s=(r("99af"),r("b0c0"),r("2f62")),l={data:function(){return{ruleForm:{userid:"2018111090",title:"",type:"贴子",newstype:"校园卡丢失",subjecttype:"避雷",content:""},rules:{title:[{required:!0,message:"请填写标题",trigger:"blur"},{max:25,message:"长度不超过 25 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],newstype:[{required:!0,message:"请选择贴子类型",trigger:"change"}],subjecttype:[{required:!0,message:"请选择话题类型",trigger:"change"}],content:[{required:!0,message:"请填写内容",trigger:"blur"},{min:20,max:1e3,message:"长度在 20 到 1000 个字符",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,fileList:[]}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(r){if(!r)return t.$message({showClose:!0,message:"发布失败",type:"error"}),!1;var o=t,a=0;if("贴子"==o.ruleForm.type){switch(o.ruleForm.newstype){case"校园卡丢失":a=0;break;case"寻物":a=1;break;case"寻主":a=2;break;case"捞人":a=3;break;case"求助":a=4;break}t.$axios.post("/news/add",{userid:o.currentUser.userid,newstitle:o.ruleForm.title,content:o.ruleForm.content,newstype:a}).then((function(r){200==r.data.code?(t.$refs[e].resetFields(),t.$message({showClose:!0,message:r.data.msg,type:"success"}),t.$router.push({path:"/"})):t.$message({showClose:!0,message:r.data.msg,type:"error"})}))}else{switch(o.ruleForm.subjecttype){case"避雷":a=0;break;case"树洞":a=1;break;case"指南":a=2;break;case"课程":a=3;break}t.$axios.post("/subject/add",{userid:o.currentUser.userid,subjecttitle:o.ruleForm.title,content:o.ruleForm.content,subjecttype:a}).then((function(r){200==r.data.code?(t.$refs[e].resetFields(),t.$message({showClose:!0,message:r.data.msg,type:"success"}),t.$router.push({path:"/"})):t.$message({showClose:!0,message:r.data.msg,type:"error"})}))}}))},gotoHome:function(e){this.$refs[e].resetFields(),this.$router.push({path:"/"})},handlePreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove:function(e,t){console.log(e,t)},handleExceed:function(e,t){this.$message.warning("当前限制最多插入 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},handleBeforeUpload:function(e){var t="image/jpeg"===e.type,r=e.size/1024/1024<2;return t||this.$message.error("上传图片只能是 JPG 格式!"),r||this.$message.error("上传图片大小不能超过 2MB!"),t&&r},handleBeforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleChange:function(e,t){var r="image/jpeg"===e.raw.type,o=e.size/1024/1024<2;r?o||(this.$message.error("上传图片大小不能超过 2MB!"),t.pop()):(this.$message.error("上传图片只能是 JPG 格式!"),t.pop())}},computed:Object(i["a"])({},Object(s["b"])(["currentUser","isAuthenticated"]))},n=l,u=(r("b351"),r("2877")),c=Object(u["a"])(n,o,a,!1,null,"aff812f8",null);t["default"]=c.exports},2027:function(e,t,r){},"99af":function(e,t,r){"use strict";var o=r("23e7"),a=r("da84"),i=r("d039"),s=r("e8b5"),l=r("861d"),n=r("7b0b"),u=r("07fa"),c=r("8418"),d=r("65f0"),m=r("1dde"),p=r("b622"),b=r("2d00"),f=p("isConcatSpreadable"),g=9007199254740991,h="Maximum allowed index exceeded",v=a.TypeError,y=b>=51||!i((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),w=m("concat"),F=function(e){if(!l(e))return!1;var t=e[f];return void 0!==t?!!t:s(e)},$=!y||!w;o({target:"Array",proto:!0,forced:$},{concat:function(e){var t,r,o,a,i,s=n(this),l=d(s,0),m=0;for(t=-1,o=arguments.length;t<o;t++)if(i=-1===t?s:arguments[t],F(i)){if(a=u(i),m+a>g)throw v(h);for(r=0;r<a;r++,m++)r in i&&c(l,m,i[r])}else{if(m>=g)throw v(h);c(l,m++,i)}return l.length=m,l}})},b0c0:function(e,t,r){var o=r("83ab"),a=r("5e77").EXISTS,i=r("e330"),s=r("9bf2").f,l=Function.prototype,n=i(l.toString),u=/^\s*function ([^ (]*)/,c=i(u.exec),d="name";o&&!a&&s(l,d,{configurable:!0,get:function(){try{return c(u,n(this))[1]}catch(e){return""}}})},b351:function(e,t,r){"use strict";r("2027")}}]);
//# sourceMappingURL=chunk-79ea506d.52143026.js.map